Starting test

# NO AUG 

loss_cb/final2-stardist_class-noaug-loss-epoch=198-val_loss=2.05.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7270 │
│      recall      │ 0.8243 │
│       acc        │ 0.6295 │
│        f1        │ 0.7726 │
│ panoptic_quality │ 0.5933 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9365041851997375 │ 0.6058475971221924 │
│      F1      │ 0.9365041851997375 │ 0.5697522163391113 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7240   │   0.1594   │ 0.0283 │   0.0958   │      0.2711       │
│      recall      │   0.0000   │   0.8163   │   0.1565   │ 0.0355 │   0.1238   │      0.2717       │
│       acc        │   0.0000   │   0.6226   │   0.0857   │ 0.0160 │   0.0571   │      0.1570       │
│        f1        │   0.0000   │   0.7674   │   0.1579   │ 0.0315 │   0.1080   │      0.2714       │
│ panoptic_quality │   0.0000   │   0.4858   │   0.0900   │ 0.0201 │   0.0706   │      0.1501       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------
# NO AUG BEST

final2_stardist_noaug_200epochs_0.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7282 │
│      recall      │ 0.8235 │
│       acc        │ 0.6299 │
│        f1        │ 0.7729 │
│ panoptic_quality │ 0.5935 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9365646839141846 │ 0.6054179668426514 │
│      F1      │ 0.9365646839141846 │ 0.5702050924301147 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7217   │   0.1544   │ 0.0235 │   0.1008   │      0.2733       │
│      recall      │   0.0000   │   0.8138   │   0.1519   │ 0.0296 │   0.1287   │      0.2739       │
│       acc        │   0.0000   │   0.6194   │   0.0829   │ 0.0133 │   0.0599   │      0.1585       │
│        f1        │   0.0000   │   0.7650   │   0.1531   │ 0.0262 │   0.1130   │      0.2736       │
│ panoptic_quality │   0.0000   │   0.4841   │   0.0874   │ 0.0164 │   0.0733   │      0.1510       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------



loss_cb/final2-stardist_class-rotate-loss-epoch=197-val_loss=2.00.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7507 │
│      recall      │ 0.8209 │
│       acc        │ 0.6451 │
│        f1        │ 0.7843 │
│ panoptic_quality │ 0.6008 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9401472806930542 │ 0.6154972910881042 │
│      F1      │ 0.9401472806930542 │ 0.5766310691833496 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0070   │   0.8157   │   0.1670   │ 0.0185 │   0.0816   │      0.4353       │
│      recall      │   0.0150   │   0.8240   │   0.1678   │ 0.0237 │   0.0990   │      0.4343       │
│       acc        │   0.0048   │   0.6946   │   0.0914   │ 0.0105 │   0.0468   │      0.2778       │
│        f1        │   0.0095   │   0.8198   │   0.1674   │ 0.0208 │   0.0895   │      0.4348       │
│ panoptic_quality │   0.0060   │   0.5240   │   0.1004   │ 0.0130 │   0.0584   │      0.2450       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------

final2_stardist_rotate_200epochs_0.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7476 │
│      recall      │ 0.8217 │
│       acc        │ 0.6433 │
│        f1        │ 0.7829 │
│ panoptic_quality │ 0.5989 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9396748542785645 │ 0.6111001968383789 │
│      F1      │ 0.9396748542785645 │ 0.5740339756011963 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0046   │   0.8157   │   0.1599   │ 0.0190 │   0.0773   │      0.4161       │
│      recall      │   0.0100   │   0.8240   │   0.1610   │ 0.0237 │   0.0891   │      0.4143       │
│       acc        │   0.0032   │   0.6946   │   0.0872   │ 0.0107 │   0.0432   │      0.2620       │
│        f1        │   0.0063   │   0.8198   │   0.1605   │ 0.0211 │   0.0828   │      0.4152       │
│ panoptic_quality │   0.0035   │   0.5224   │   0.0975   │ 0.0137 │   0.0544   │      0.2343       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------

loss_cb/final2-stardist_class-rotate_bright-loss-epoch=180-val_loss=2.04.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7316 │
│      recall      │ 0.8235 │
│       acc        │ 0.6325 │
│        f1        │ 0.7749 │
│ panoptic_quality │ 0.5888 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9363261461257935 │ 0.5765858888626099 │
│      F1      │ 0.9363261461257935 │ 0.547566294670105  │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7524   │   0.1281   │ 0.0289 │   0.0863   │      0.3519       │
│      recall      │   0.0000   │   0.8138   │   0.1270   │ 0.0325 │   0.0842   │      0.3519       │
│       acc        │   0.0000   │   0.6419   │   0.0681   │ 0.0156 │   0.0445   │      0.2135       │
│        f1        │   0.0000   │   0.7819   │   0.1276   │ 0.0306 │   0.0852   │      0.3519       │
│ panoptic_quality │   0.0000   │   0.4947   │   0.0749   │ 0.0208 │   0.0627   │      0.1966       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------

final2_stardist_rotate_brigth_200epochs_0.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7422 │
│      recall      │ 0.8139 │
│       acc        │ 0.6345 │
│        f1        │ 0.7764 │
│ panoptic_quality │ 0.5910 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9364837408065796 │ 0.5734546184539795 │
│      F1      │ 0.9364837408065796 │ 0.5454635620117188 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7559   │   0.1106   │ 0.0214 │   0.0984   │      0.3281       │
│      recall      │   0.0000   │   0.8138   │   0.1088   │ 0.0237 │   0.0941   │      0.3274       │
│       acc        │   0.0000   │   0.6444   │   0.0580   │ 0.0114 │   0.0505   │      0.1960       │
│        f1        │   0.0000   │   0.7838   │   0.1097   │ 0.0225 │   0.0962   │      0.3278       │
│ panoptic_quality │   0.0000   │   0.4944   │   0.0647   │ 0.0175 │   0.0700   │      0.1824       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------

loss_cb/final2-stardist_class-crop-loss-epoch=190-val_loss=2.01.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7572 │
│      recall      │ 0.8177 │
│       acc        │ 0.6478 │
│        f1        │ 0.7862 │
│ panoptic_quality │ 0.6041 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9372592568397522 │ 0.5889583826065063 │
│      F1      │ 0.9372592568397522 │ 0.554431676864624  │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7465   │   0.1622   │ 0.0200 │   0.0566   │      0.3154       │
│      recall      │   0.0000   │   0.8189   │   0.1633   │ 0.0237 │   0.0594   │      0.3140       │
│       acc        │   0.0000   │   0.6407   │   0.0886   │ 0.0109 │   0.0299   │      0.1868       │
│        f1        │   0.0000   │   0.7810   │   0.1627   │ 0.0217 │   0.0580   │      0.3147       │
│ panoptic_quality │   0.0000   │   0.4920   │   0.0924   │ 0.0152 │   0.0439   │      0.1764       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------

final2_stardist_crop_200epochs_0.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7632 │
│      recall      │ 0.8116 │
│       acc        │ 0.6484 │
│        f1        │ 0.7867 │
│ panoptic_quality │ 0.6044 │
└──────────────────┴────────┘
                 Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro       ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.937726616859436 │ 0.5853079557418823 │
│      F1      │ 0.937726616859436 │ 0.5563675761222839 │
└──────────────┴───────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7494   │   0.1734   │ 0.0174 │   0.0664   │      0.3132       │
│      recall      │   0.0000   │   0.8240   │   0.1746   │ 0.0207 │   0.0693   │      0.3118       │
│       acc        │   0.0000   │   0.6460   │   0.0953   │ 0.0095 │   0.0351   │      0.1852       │
│        f1        │   0.0000   │   0.7849   │   0.1740   │ 0.0189 │   0.0678   │      0.3125       │
│ panoptic_quality │   0.0000   │   0.4922   │   0.0988   │ 0.0142 │   0.0491   │      0.1752       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

------------------------------------------------------------

loss_cb/final2-stardist_class-noaug-loss-epoch=198-val_loss=2.05.ckpt		    0.5933
final2_stardist_noaug_200epochs_0.0losspower_0.0005lr.ckpt			            0.5935
loss_cb/final2-stardist_class-rotate-loss-epoch=197-val_loss=2.00.ckpt		    0.6008
final2_stardist_rotate_200epochs_0.0losspower_0.0005lr.ckpt			            0.5989
loss_cb/final2-stardist_class-rotate_bright-loss-epoch=180-val_loss=2.04.ckpt	0.5888
final2_stardist_rotate_brigth_200epochs_0.0losspower_0.0005lr.ckpt		        0.5910
loss_cb/final2-stardist_class-crop-loss-epoch=190-val_loss=2.01.ckpt		    0.6041
final2_stardist_crop_200epochs_0.0losspower_0.0005lr.ckpt			            0.6044

