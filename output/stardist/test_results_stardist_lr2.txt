Starting test
loss_cb/final3-stardist_class-1.0losspower_0.0004lr-crop-cosine-loss-epoch=186-val_loss=3.39.ckpt
Testing pipeline...
Using device: cuda
Loading data...
validation mode
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7932 │
│      recall      │ 0.8438 │
│       acc        │ 0.6916 │
│        f1        │ 0.8177 │
│ panoptic_quality │ 0.6368 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9433472156524658 │ 0.6386153101921082 │
│      F1      │ 0.9433472156524658 │ 0.5971027612686157 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0160   │   0.7788   │   0.1874   │ 0.0258 │   0.1121   │      0.5333       │
│      recall      │   0.0350   │   0.8444   │   0.1882   │ 0.0296 │   0.1188   │      0.5345       │
│       acc        │   0.0111   │   0.6811   │   0.1036   │ 0.0140 │   0.0612   │      0.3642       │
│        f1        │   0.0220   │   0.8103   │   0.1878   │ 0.0275 │   0.1154   │      0.5339       │
│ panoptic_quality │   0.0132   │   0.5261   │   0.1087   │ 0.0190 │   0.0766   │      0.3090       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
final3_stardist_crop-cosine_200epochs_1.0losspower_0.0004lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
validation mode
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7958 │
│      recall      │ 0.8416 │
│       acc        │ 0.6921 │
│        f1        │ 0.8181 │
│ panoptic_quality │ 0.6375 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9439165592193604 │ 0.6435980796813965 │
│      F1      │ 0.9439165592193604 │ 0.6058836579322815 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0141   │   0.7825   │   0.2152   │ 0.0179 │   0.1324   │      0.5533       │
│      recall      │   0.0300   │   0.8444   │   0.2177   │ 0.0207 │   0.1436   │      0.5546       │
│       acc        │   0.0097   │   0.6839   │   0.1214   │ 0.0097 │   0.0740   │      0.3831       │
│        f1        │   0.0192   │   0.8123   │   0.2165   │ 0.0192 │   0.1378   │      0.5539       │
│ panoptic_quality │   0.0115   │   0.5279   │   0.1253   │ 0.0130 │   0.0864   │      0.3205       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
loss_cb/final3-stardist_class-1.0losspower_0.0006lr-crop-cosine-loss-epoch=186-val_loss=3.40.ckpt
Testing pipeline...
Using device: cuda
Loading data...
validation mode
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.8043 │
│      recall      │ 0.8339 │
│       acc        │ 0.6932 │
│        f1        │ 0.8188 │
│ panoptic_quality │ 0.6374 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9440118074417114 │ 0.6267597675323486 │
│      F1      │ 0.9440118074417114 │ 0.5965323448181152 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0023   │   0.7991   │   0.1765   │ 0.0264 │   0.1270   │      0.5686       │
│      recall      │   0.0050   │   0.8622   │   0.1769   │ 0.0296 │   0.1188   │      0.5724       │
│       acc        │   0.0016   │   0.7086   │   0.0969   │ 0.0141 │   0.0654   │      0.3991       │
│        f1        │   0.0032   │   0.8294   │   0.1767   │ 0.0279 │   0.1228   │      0.5705       │
│ panoptic_quality │   0.0018   │   0.5377   │   0.1039   │ 0.0151 │   0.0862   │      0.3276       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
final3_stardist_crop-cosine_200epochs_1.0losspower_0.0006lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
validation mode
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.8066 │
│      recall      │ 0.8334 │
│       acc        │ 0.6946 │
│        f1        │ 0.8198 │
│ panoptic_quality │ 0.6389 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9447049498558044 │ 0.6351790428161621 │
│      F1      │ 0.9447049498558044 │ 0.6060881614685059 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0048   │   0.8061   │   0.2000   │ 0.0261 │   0.1038   │      0.6195       │
│      recall      │   0.0100   │   0.8699   │   0.2018   │ 0.0296 │   0.1089   │      0.6236       │
│       acc        │   0.0033   │   0.7194   │   0.1117   │ 0.0141 │   0.0561   │      0.4509       │
│        f1        │   0.0065   │   0.8368   │   0.2009   │ 0.0277 │   0.1063   │      0.6215       │
│ panoptic_quality │   0.0036   │   0.5428   │   0.1193   │ 0.0159 │   0.0725   │      0.3559       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
