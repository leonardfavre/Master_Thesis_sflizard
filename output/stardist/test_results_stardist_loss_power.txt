Starting test
loss_cb/final2-stardist_class-0.0losspower_0.0005lr-noaug_nopower-loss-epoch=73-val_loss=1.61.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.5587 │
│      recall      │ 0.7460 │
│       acc        │ 0.4694 │
│        f1        │ 0.6389 │
│ panoptic_quality │ 0.4458 │
└──────────────────┴────────┘
                  Classification metrics                   
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃        macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9153741002082825 │ 0.5306864976882935  │
│      F1      │ 0.9153741002082825 │ 0.48285356163978577 │
└──────────────┴────────────────────┴─────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.6022   │   0.0068   │ 0.0071 │   0.0159   │      0.0290       │
│      recall      │   0.0000   │   0.6913   │   0.0068   │ 0.0089 │   0.0248   │      0.0290       │
│       acc        │   0.0000   │   0.4746   │   0.0034   │ 0.0040 │   0.0098   │      0.0147       │
│        f1        │   0.0000   │   0.6437   │   0.0068   │ 0.0079 │   0.0193   │      0.0290       │
│ panoptic_quality │   0.0000   │   0.3687   │   0.0038   │ 0.0043 │   0.0128   │      0.0153       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
loss_cb/final2-nopower-stardist_class-0.0losspower_0.0005lr-noaug-loss-epoch=199-val_loss=1.53.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.6543 │
│      recall      │ 0.7787 │
│       acc        │ 0.5517 │
│        f1        │ 0.7111 │
│ panoptic_quality │ 0.5237 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9320930242538452 │ 0.5830304026603699 │
│      F1      │ 0.9320930242538452 │ 0.5456793308258057 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7380   │   0.1139   │ 0.0070 │   0.0985   │      0.1552       │
│      recall      │   0.0000   │   0.7832   │   0.1134   │ 0.0089 │   0.0990   │      0.1559       │
│       acc        │   0.0000   │   0.6128   │   0.0602   │ 0.0039 │   0.0519   │      0.0843       │
│        f1        │   0.0000   │   0.7599   │   0.1136   │ 0.0078 │   0.0988   │      0.1556       │
│ panoptic_quality │   0.0000   │   0.4584   │   0.0647   │ 0.0053 │   0.0611   │      0.0848       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

final2_stardist_nopower-noaug_200epochs_0.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.6543 │
│      recall      │ 0.7787 │
│       acc        │ 0.5517 │
│        f1        │ 0.7111 │
│ panoptic_quality │ 0.5237 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9320930242538452 │ 0.5830304026603699 │
│      F1      │ 0.9320930242538452 │ 0.5456793308258057 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7380   │   0.1139   │ 0.0070 │   0.0985   │      0.1552       │
│      recall      │   0.0000   │   0.7832   │   0.1134   │ 0.0089 │   0.0990   │      0.1559       │
│       acc        │   0.0000   │   0.6128   │   0.0602   │ 0.0039 │   0.0519   │      0.0843       │
│        f1        │   0.0000   │   0.7599   │   0.1136   │ 0.0078 │   0.0988   │      0.1556       │
│ panoptic_quality │   0.0000   │   0.4584   │   0.0647   │ 0.0053 │   0.0611   │      0.0848       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

loss_cb/final2-stardist_class-1.0losspower_0.0005lr-noaug-loss-epoch=72-val_loss=3.68.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7337 │
│      recall      │ 0.7925 │
│       acc        │ 0.6155 │
│        f1        │ 0.7620 │
│ panoptic_quality │ 0.5811 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9343711733818054 │ 0.5365903377532959 │
│      F1      │ 0.9343711733818054 │ 0.5319538712501526 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.6907   │   0.1000   │ 0.0322 │   0.0860   │      0.1744       │
│      recall      │   0.0000   │   0.7806   │   0.0930   │ 0.0355 │   0.0792   │      0.1759       │
│       acc        │   0.0000   │   0.5784   │   0.0506   │ 0.0172 │   0.0430   │      0.0960       │
│        f1        │   0.0000   │   0.7329   │   0.0964   │ 0.0338 │   0.0825   │      0.1752       │
│ panoptic_quality │   0.0000   │   0.4540   │   0.0581   │ 0.0237 │   0.0544   │      0.0957       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
loss_cb/final2-stardist_class-1.0losspower_0.0005lr-noaug-loss-epoch=135-val_loss=3.53.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7638 │
│      recall      │ 0.8307 │
│       acc        │ 0.6609 │
│        f1        │ 0.7958 │
│ panoptic_quality │ 0.6169 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9400621652603149 │ 0.5919512510299683 │
│      F1      │ 0.9400621652603149 │ 0.5628275275230408 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0069   │   0.7694   │   0.1545   │ 0.0273 │   0.1207   │      0.4578       │
│      recall      │   0.0150   │   0.8342   │   0.1542   │ 0.0325 │   0.1040   │      0.4588       │
│       acc        │   0.0047   │   0.6673   │   0.0836   │ 0.0151 │   0.0592   │      0.2973       │
│        f1        │   0.0094   │   0.8005   │   0.1544   │ 0.0297 │   0.1117   │      0.4583       │
│ panoptic_quality │   0.0065   │   0.5073   │   0.0916   │ 0.0204 │   0.0779   │      0.2639       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
final2_stardist_noaug_200epochs_1.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7739 │
│      recall      │ 0.8255 │
│       acc        │ 0.6651 │
│        f1        │ 0.7989 │
│ panoptic_quality │ 0.6228 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9419271349906921 │ 0.5979198813438416 │
│      F1      │ 0.9419271349906921 │ 0.5807316303253174 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0094   │   0.7494   │   0.1834   │ 0.0355 │   0.1302   │      0.4543       │
│      recall      │   0.0200   │   0.8316   │   0.1859   │ 0.0414 │   0.1238   │      0.4543       │
│       acc        │   0.0065   │   0.6507   │   0.1017   │ 0.0195 │   0.0678   │      0.2939       │
│        f1        │   0.0128   │   0.7884   │   0.1847   │ 0.0383 │   0.1269   │      0.4543       │
│ panoptic_quality │   0.0078   │   0.5024   │   0.1076   │ 0.0274 │   0.0847   │      0.2628       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
