Starting test
loss_cb/final3-stardist_class-1.0losspower_0.0005lr-crop-cosine-loss-epoch=186-val_loss=3.39.ckpt
Testing pipeline...
Using device: cuda
Loading data...
validation mode
Data loaded.
Loading stardist model...
Stardist model loaded.
Loading graph model...
Graph model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7989 │
│      recall      │ 0.8399 │
│       acc        │ 0.6933 │
│        f1        │ 0.8189 │
│ panoptic_quality │ 0.6381 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9438951015472412 │ 0.624819278717041  │
│      F1      │ 0.9438951015472412 │ 0.5955662727355957 │
└──────────────┴────────────────────┴────────────────────┘
                                      Per class metrics                                      
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃              ┃            ┃            ┃            ┃        ┃            ┃  Connective   ┃
┃    Class     ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃    tissue     ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│  precision   │   0.0000   │   0.7867   │   0.2027   │ 0.0291 │   0.1711   │    0.5787     │
│    recall    │   0.0000   │   0.8469   │   0.2041   │ 0.0325 │   0.1584   │    0.5813     │
│     acc      │   0.0000   │   0.6888   │   0.1132   │ 0.0156 │   0.0896   │    0.4085     │
│      f1      │   0.0000   │   0.8157   │   0.2034   │ 0.0307 │   0.1645   │    0.5800     │
│ panoptic_qu… │   0.0000   │   0.5276   │   0.1159   │ 0.0188 │   0.1086   │    0.3362     │
└──────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────┘

Graph results:

                  Classification metrics                   
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃        macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.8743367791175842 │ 0.28679171204566956 │
│      F1      │ 0.8743367791175842 │ 0.22620415687561035 │
└──────────────┴────────────────────┴─────────────────────┘
                                      Per class metrics                                      
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃              ┃            ┃            ┃            ┃        ┃            ┃  Connective   ┃
┃    Class     ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃    tissue     ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│  precision   │   0.0067   │   0.0000   │   0.0000   │ 0.0000 │   0.0022   │    0.0665     │
│    recall    │   0.0100   │   0.0000   │   0.0000   │ 0.0000 │   0.0050   │    0.0668     │
│     acc      │   0.0040   │   0.0000   │   0.0000   │ 0.0000 │   0.0015   │    0.0345     │
│      f1      │   0.0080   │   0.0000   │   0.0000   │ 0.0000 │   0.0031   │    0.0667     │
│ panoptic_qu… │   0.0052   │   0.0000   │   0.0000   │ 0.0000 │   0.0017   │    0.0370     │
└──────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────┘
Plotting...
Done.
final3_stardist_crop-cosine_200epochs_1.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
validation mode
Data loaded.
Loading stardist model...
Stardist model loaded.
Loading graph model...
Graph model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.8034 │
│      recall      │ 0.8370 │
│       acc        │ 0.6947 │
│        f1        │ 0.8198 │
│ panoptic_quality │ 0.6397 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9444988369941711 │ 0.6322556734085083 │
│      F1      │ 0.9444988369941711 │ 0.6036598682403564 │
└──────────────┴────────────────────┴────────────────────┘
                                      Per class metrics                                      
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃              ┃            ┃            ┃            ┃        ┃            ┃  Connective   ┃
┃    Class     ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃    tissue     ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│  precision   │   0.0046   │   0.7849   │   0.2309   │ 0.0392 │   0.1561   │    0.5920     │
│    recall    │   0.0100   │   0.8469   │   0.2336   │ 0.0444 │   0.1584   │    0.5947     │
│     acc      │   0.0032   │   0.6874   │   0.1314   │ 0.0212 │   0.0853   │    0.4218     │
│      f1      │   0.0063   │   0.8147   │   0.2322   │ 0.0416 │   0.1572   │    0.5933     │
│ panoptic_qu… │   0.0034   │   0.5280   │   0.1329   │ 0.0261 │   0.1031   │    0.3451     │
└──────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────┘

Graph results:

                  Classification metrics                   
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃        macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.8747639060020447 │ 0.28576046228408813 │
│      F1      │ 0.8747639060020447 │ 0.22362840175628662 │
└──────────────┴────────────────────┴─────────────────────┘
                                      Per class metrics                                      
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃              ┃            ┃            ┃            ┃        ┃            ┃  Connective   ┃
┃    Class     ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃    tissue     ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│  precision   │   0.0104   │   0.0000   │   0.0000   │ 0.0000 │   0.0044   │    0.0687     │
│    recall    │   0.0150   │   0.0000   │   0.0000   │ 0.0000 │   0.0099   │    0.0690     │
│     acc      │   0.0062   │   0.0000   │   0.0000   │ 0.0000 │   0.0031   │    0.0357     │
│      f1      │   0.0123   │   0.0000   │   0.0000   │ 0.0000 │   0.0061   │    0.0689     │
│ panoptic_qu… │   0.0077   │   0.0000   │   0.0000   │ 0.0000 │   0.0033   │    0.0382     │
└──────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────┘
Plotting...
Done.
