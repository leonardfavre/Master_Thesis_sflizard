Starting test
loss_cb/final3-stardist_class-1.0losspower_0.0005lr-rotate-loss-epoch=197-val_loss=3.48.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7704 │
│      recall      │ 0.8417 │
│       acc        │ 0.6729 │
│        f1        │ 0.8045 │
│ panoptic_quality │ 0.6221 │
└──────────────────┴────────┘
                 Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro       ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.939441442489624 │ 0.6082780361175537 │
│      F1      │ 0.939441442489624 │ 0.5627332925796509 │
└──────────────┴───────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7730   │   0.1341   │ 0.0298 │   0.1287   │      0.4368       │
│      recall      │   0.0000   │   0.8342   │   0.1338   │ 0.0355 │   0.1287   │      0.4388       │
│       acc        │   0.0000   │   0.6701   │   0.0718   │ 0.0165 │   0.0688   │      0.2802       │
│        f1        │   0.0000   │   0.8025   │   0.1339   │ 0.0324 │   0.1287   │      0.4378       │
│ panoptic_quality │   0.0000   │   0.5153   │   0.0791   │ 0.0198 │   0.0895   │      0.2531       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
final3_stardist_rotate_200epochs_1.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7676 │
│      recall      │ 0.8431 │
│       acc        │ 0.6717 │
│        f1        │ 0.8036 │
│ panoptic_quality │ 0.6211 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9391544461250305 │ 0.6098865270614624 │
│      F1      │ 0.9391544461250305 │ 0.562518835067749  │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7796   │   0.1403   │ 0.0320 │   0.1337   │      0.4479       │
│      recall      │   0.0000   │   0.8393   │   0.1406   │ 0.0385 │   0.1337   │      0.4499       │
│       acc        │   0.0000   │   0.6784   │   0.0755   │ 0.0178 │   0.0716   │      0.2894       │
│        f1        │   0.0000   │   0.8084   │   0.1404   │ 0.0349 │   0.1337   │      0.4489       │
│ panoptic_quality │   0.0000   │   0.5182   │   0.0823   │ 0.0211 │   0.0901   │      0.2597       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
loss_cb/final3-stardist_class-1.0losspower_0.0005lr-rotate+bright-loss-epoch=199-val_loss=3.47.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7808 │
│      recall      │ 0.8265 │
│       acc        │ 0.6709 │
│        f1        │ 0.8030 │
│ panoptic_quality │ 0.6191 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9404269456863403 │ 0.5949053168296814 │
│      F1      │ 0.9404268860816956 │ 0.5657690763473511 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7431   │   0.1586   │ 0.0149 │   0.1324   │      0.4053       │
│      recall      │   0.0000   │   0.8189   │   0.1565   │ 0.0178 │   0.1337   │      0.4053       │
│       acc        │   0.0000   │   0.6382   │   0.0855   │ 0.0082 │   0.0712   │      0.2542       │
│        f1        │   0.0000   │   0.7791   │   0.1575   │ 0.0162 │   0.1330   │      0.4053       │
│ panoptic_quality │   0.0000   │   0.4929   │   0.0916   │ 0.0096 │   0.0883   │      0.2318       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
final3_stardist_rotate+bright_200epochs_1.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7808 │
│      recall      │ 0.8265 │
│       acc        │ 0.6709 │
│        f1        │ 0.8030 │
│ panoptic_quality │ 0.6191 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9404269456863403 │ 0.5949053168296814 │
│      F1      │ 0.9404268860816956 │ 0.5657690763473511 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7431   │   0.1586   │ 0.0149 │   0.1324   │      0.4053       │
│      recall      │   0.0000   │   0.8189   │   0.1565   │ 0.0178 │   0.1337   │      0.4053       │
│       acc        │   0.0000   │   0.6382   │   0.0855   │ 0.0082 │   0.0712   │      0.2542       │
│        f1        │   0.0000   │   0.7791   │   0.1575   │ 0.0162 │   0.1330   │      0.4053       │
│ panoptic_quality │   0.0000   │   0.4929   │   0.0916   │ 0.0096 │   0.0883   │      0.2318       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘

final3_stardist_crop_200epochs_1.0losspower_0.0005lr.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7912 │
│      recall      │ 0.8365 │
│       acc        │ 0.6852 │
│        f1        │ 0.8132 │
│ panoptic_quality │ 0.6303 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9434117078781128 │  0.62007737159729  │
│      F1      │ 0.9434117078781128 │ 0.5890498161315918 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0023   │   0.7934   │   0.1655   │ 0.0331 │   0.1089   │      0.5311       │
│      recall      │   0.0050   │   0.8622   │   0.1655   │ 0.0355 │   0.1089   │      0.5323       │
│       acc        │   0.0016   │   0.7042   │   0.0902   │ 0.0174 │   0.0576   │      0.3621       │
│        f1        │   0.0031   │   0.8264   │   0.1655   │ 0.0343 │   0.1089   │      0.5317       │
│ panoptic_quality │   0.0018   │   0.5353   │   0.0948   │ 0.0244 │   0.0714   │      0.3077       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
loss_cb/final3-stardist_class-1.0losspower_0.0005lr-crop-loss-epoch=197-val_loss=3.42.ckpt
Testing pipeline...
Using device: cuda
Loading data...
Data loaded.
Loading stardist model...
Stardist model loaded.
Testing...
Test done.

Results:

    Segmentation metrics     
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃      Metric      ┃ Value  ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│    precision     │ 0.7941 │
│      recall      │ 0.8338 │
│       acc        │ 0.6856 │
│        f1        │ 0.8135 │
│ panoptic_quality │ 0.6320 │
└──────────────────┴────────┘
                  Classification metrics                  
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ metric \ avg ┃       micro        ┃       macro        ┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│   Accuracy   │ 0.9435831904411316 │ 0.6209391951560974 │
│      F1      │ 0.9435831904411316 │ 0.5894150733947754 │
└──────────────┴────────────────────┴────────────────────┘
                                          Per class metrics                                          
┏━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃      Class       ┃ Neutrophil ┃ Epithelial ┃ Lymphocyte ┃ Plasma ┃ Eosinophil ┃ Connective tissue ┃
┡━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│    precision     │   0.0000   │   0.7962   │   0.1487   │ 0.0444 │   0.0791   │      0.5388       │
│      recall      │   0.0000   │   0.8571   │   0.1474   │ 0.0473 │   0.0842   │      0.5412       │
│       acc        │   0.0000   │   0.7029   │   0.0800   │ 0.0235 │   0.0425   │      0.3699       │
│        f1        │   0.0000   │   0.8256   │   0.1481   │ 0.0458 │   0.0815   │      0.5400       │
│ panoptic_quality │   0.0000   │   0.5363   │   0.0857   │ 0.0310 │   0.0535   │      0.3123       │
└──────────────────┴────────────┴────────────┴────────────┴────────┴────────────┴───────────────────┘
